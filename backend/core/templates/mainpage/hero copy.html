{% load static i18n %}
{% include 'includes/header.html' %}
<div class="page-title style-3" id="qodef-page-outer">
    <div class="thumbs">
        <div class="swiper hero-slider" data-autoplay="true" data-delay="5000">
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <div class="slide-inner effect-img-zoom">
                        <img class="img-zoom" loading="eager" decoding="async" src="{% static 'images/h1-rev-img-3b.webp' %}" width="1920" height="1000" alt="Luxury Car">
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner effect-img-zoom">
                        <img class="img-zoom" loading="eager" decoding="async" src="{% static 'images/h1-rev-img-1b.webp' %}" width="1920" height="1000" alt="Luxury Car">
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner effect-img-zoom">
                        <img class="img-zoom" loading="eager" decoding="async" src="{% static 'images/h1-rev-img-2b.webp' %}" width="1920" height="1000" alt="Luxury Car">
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner effect-img-zoom">
                        <img class="img-zoom" loading="eager" decoding="async" src="{% static 'images/h1-rev-img-4b.webp' %}" width="1920" height="1000" alt="Luxury Car">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="content">
        <div class="tf-container">
            <h1 class="title text_white qodef-m-title mb_16 hero_title">
                Looking to Rent a Luxury Car?<br>Send A Request
            </h1>
            <p class="text_color-1 hero_subtitle">
                Complete the form below and we'll contact you as soon as possible
            </p>
        </div>
    </div>
    <div class="flat-tab flat-tab-form">
        <div class="tf-container">
            <div class="wg-filter">
                <div class="widget-content-inner active">
                    {% csrf_token %}
                    <div class="form-title">
                        <div class="wrap-fill d-flex align-items-end">
                            <div class="form-field">
                                <input type="text" placeholder="Choose location" class="form-input-custom">
                            </div>
                            <div class="form-field">
                                <input type="date" class="form-input-custom" value="{% now 'Y-m-d' %}">
                            </div>
                            <div class="form-field">
                                <input type="time" placeholder="Select time" class="form-input-custom">
                            </div>
                            <div class="form-field">
    <select class="form-input-custom">
        <option value="" disabled selected>Car class</option>
        <option value="sport">Sport</option>
        <option value="suv">SUV</option>
        <option value="luxury">Luxury</option>
        <option value="business">Business</option>
    </select>
</div>
                            <div class="form-field">
                                <input type="text" placeholder="Drop off location" class="form-input-custom">
                            </div>
                            <div class="form-field">
                                <input type="tel" placeholder="Your phone/WhatsApp" class="form-input-custom">
                            </div>
                            <div class="form-field">
                                <button type="submit" class="btn-send-custom" data-gtag-event="hero_form_submit">
                                    <span style="font-size: 20px;">+</span>
                                    <span> SEND</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<style>
.page-title.style-3 .thumbs {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
}
.page-title.style-3 .thumbs .swiper,
.page-title.style-3 .thumbs .swiper-wrapper,
.page-title.style-3 .thumbs .swiper-slide {
    height: 100%;
}
.page-title.style-3 .thumbs .slide-inner {
    height: 100%;
}
.page-title.style-3 .thumbs .slide-inner img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
.page-title.style-3 {
    position: relative;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    padding-bottom: 120px;
}
.page-title.style-3 .thumbs {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    overflow: hidden;
}
.page-title.style-3 .thumbs .hero-slider {
    width: 100%;
    height: 100%;
}
.page-title.style-3 .thumbs .swiper-wrapper {
    height: 100%;
}
.page-title.style-3 .thumbs .swiper-slide {
    height: 100%;
}
.page-title.style-3 .thumbs .slide-inner {
    width: 100%;
    height: 100%;
}
.page-title.style-3 .thumbs .slide-inner img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
.page-title.style-3 .content {
    position: relative;
    z-index: 2;
    text-align: left;
}
.page-title.style-3 .flat-tab-form {
    position: relative;
    z-index: 2;
}
.page-title.style-3 .thumbs .slide-inner img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 6s ease-out;
    transform: scale(1);
}
.page-title.style-3 .thumbs .swiper-slide-active .slide-inner img {
    transform: scale(1.1);
}
#qodef-page-outer {
    margin-top: 0px;
}
#qodef-page-outer {
    position: relative;
}
/* Hero Form */
.flat-tab-form {
    position: relative;
    z-index: 2;
}
.form-title .wrap-fill {
    display: flex;
    align-items: flex-end;
    gap: 0;
}
.form-field {
    flex: 1;
}
.form-field:first-child {
    padding-left: 0;
}
.form-field:last-child {
    border-right: none;
    flex: 0 0 auto;
    padding-right: 0;
}
.form-input-custom {
    background: transparent;
    border: none;
    border-bottom: 1px solid rgba(255, 255, 255, 0.3);
    color: #fff;
    font-family: Inconsolata, sans-serif;
    font-size: 15px;
    letter-spacing: 1px;
    padding: 12px 0;
    width: 100%;
    outline: none;
}
.form-input-custom::placeholder {
    color: rgba(255, 255, 255, 0.7);
}
.form-input-custom:focus {
    border-bottom-color: #bfa37c;
}
input[type="date"].form-input-custom::-webkit-calendar-picker-indicator,
input[type="time"].form-input-custom::-webkit-calendar-picker-indicator {
    filter: invert(1);
    cursor: pointer;
}
.btn-send-custom {
    background: transparent;
    border: 1px solid #bfa37c;
    color: #fff;
    font-family: Inconsolata, sans-serif;
    font-size: 16px;
    letter-spacing: 3px;
    cursor: pointer;
    transition: all 0.3s ease;
    white-space: nowrap;
    padding: 17px 57px 17px 60px;
    font-weight: 300;
}
.btn-send-custom:hover {
    background: #bfa37c;
    border-color: #bfa37c;
    color: #0c1315;
}
.hero_title {
    font-size: 48px;
    font-weight: 400;
    line-height: 1.2;
}
.hero_subtitle {
    font-size: 16px;
    margin-bottom: 40px;
}
@media (max-width: 767px) {
  .hero_subtitle {
    margin-bottom: 0;
    color: #fff;
  }
  .hero_title {
    font-size: 28px;
    font-weight: 400;
    line-height: 37px;
  }
  #qodef-page-outer {
    margin-top: 0px;
  }
}
/* Mobile */
@media (max-width: 991px) {
    .form-title .wrap-fill {
        flex-wrap: wrap;
        gap: 20px;
    }
    .form-field {
        flex: 0 0 48%;
        border-right: none;
        padding: 0;
    }
}
@media (max-width: 576px) {
    .form-field {
        flex: 0 0 100%;
    }
    .btn-send-custom {
        width: 100%;
        margin-top: 10px;
    }
}
.form-input-custom::placeholder {
    color: #fff;
    opacity: 1;
}
select.form-input-custom {
    color: #fff;
}
/* Для webkit браузеров (Chrome, Safari) */
.form-input-custom::-webkit-input-placeholder {
    color: #fff;
    opacity: 1;
}
/* Для Firefox */
.form-input-custom::-moz-placeholder {
    color: #fff;
    opacity: 1;
}
/* Для IE/Edge */
.form-input-custom:-ms-input-placeholder {
    color: #fff;
}
.form-input-custom::-ms-input-placeholder {
    color: #fff;
}
select.form-input-custom {
    background: transparent;
    border: none;
    border-bottom: 1px solid rgba(255, 255, 255, 0.3);
    font-family: Inconsolata, sans-serif;
    font-size: 14px;
    letter-spacing: 1px;
    padding: 12px 0;
    width: 100%;
    outline: none;
    cursor: pointer;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
}
input[type="date"].form-input-custom,
input[type="time"].form-input-custom {
    cursor: pointer;
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Hero slider
    new Swiper('.hero-slider', {
        loop: true,
        autoplay: { delay: 2000, disableOnInteraction: false },
        effect: 'fade',
        fadeEffect: { crossFade: true },
        speed: 1500
    });

    // Date/time picker
    document.querySelectorAll('input[type="date"], input[type="time"]').forEach(function(input) {
        input.addEventListener('click', function() { this.showPicker(); });
    });

    // AJAX форма бронирования
    const form = document.querySelector('.flat-tab-form');
    const submitBtn = form.querySelector('.btn-send-custom');
    
    submitBtn.addEventListener('click', function(e) {
        e.preventDefault();
        
        const formData = new FormData();
        formData.append('location', form.querySelector('input[placeholder="Choose location"]').value);
        formData.append('date', form.querySelector('input[type="date"]').value);
        formData.append('time', form.querySelector('input[type="time"]').value);
        formData.append('car_class', form.querySelector('select').value);
        formData.append('dropoff', form.querySelector('input[placeholder="Drop off location"]').value);
        formData.append('phone', form.querySelector('input[type="tel"]').value);
        
        // Валидация телефона
        const phone = formData.get('phone');
        if (!phone || phone.length < 8) {
            alert('Please enter a valid phone number');
            return;
        }
        
        // Disable button
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<span>Sending...</span>';
        
        // CSRF token
        const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]')?.value || '';
        
        fetch('/api/booking/', {
            method: 'POST',
            headers: { 'X-CSRFToken': csrfToken },
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // GA4 Event
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'generate_lead', {
                        'event_category': 'form',
                        'event_label': 'hero_booking',
                        'car_class': formData.get('car_class')
                    });
                    // Google Ads Conversion
                    gtag('event', 'conversion', {
                        'send_to': 'AW-17794321096', // Заменить на реальный
                        'value': 1.0,
                        'currency': 'EUR'
                    });
                }
                // Success message
                alert('Thank you! We will contact you shortly.');
                // Reset form
                form.querySelectorAll('input:not([type="date"])').forEach(i => i.value = '');
                form.querySelector('select').selectedIndex = 0;
            } else {
                alert(data.error || 'Error sending request');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Network error. Please try again.');
        })
        .finally(() => {
            submitBtn.disabled = false;
            submitBtn.innerHTML = '<span style="font-size: 20px;">+</span><span> SEND</span>';
        });
    });
});
</script>